<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="CleanUninstaller.Views.SettingsDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:CleanUninstaller.Views"
    Title="Paramètres"
    PrimaryButtonText="Enregistrer"
    SecondaryButtonText="Annuler"
    DefaultButton="Primary"
    PrimaryButtonClick="SaveButton_Click">

    <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="500">
        <StackPanel Spacing="24" Padding="0,8">
            
            <!-- Section Sécurité -->
            <StackPanel Spacing="12">
                <TextBlock Text="Sécurité" Style="{StaticResource SubtitleTextBlockStyle}" />
                
                <ToggleSwitch x:Name="CreateRestorePointToggle"
                              Header="Créer un point de restauration"
                              OffContent="Désactivé"
                              OnContent="Avant chaque désinstallation en lot" />

                <ToggleSwitch x:Name="CreateRegistryBackupToggle"
                              Header="Sauvegarder le registre"
                              OffContent="Désactivé"
                              OnContent="Avant chaque nettoyage" />
            </StackPanel>

            <!-- Section Désinstallation -->
            <StackPanel Spacing="12">
                <TextBlock Text="Désinstallation" Style="{StaticResource SubtitleTextBlockStyle}" />
                
                <ToggleSwitch x:Name="PreferQuietUninstallToggle"
                              Header="Désinstallation silencieuse"
                              OffContent="Utiliser l'interface standard"
                              OnContent="Quand disponible (recommandé)" />

                <ToggleSwitch x:Name="AutoScanResidualsToggle"
                              Header="Scanner les résidus automatiquement"
                              OffContent="Désactivé"
                              OnContent="Après chaque désinstallation" />
            </StackPanel>

            <!-- Section Résidus -->
            <StackPanel Spacing="12">
                <TextBlock Text="Détection des résidus" Style="{StaticResource SubtitleTextBlockStyle}" />
                
                <StackPanel Spacing="8">
                    <TextBlock Text="Confiance minimum pour sélection automatique"
                               Style="{StaticResource CaptionTextBlockStyle}" />
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <Slider x:Name="ConfidenceSlider"
                                Minimum="30"
                                Maximum="100"
                                Width="200"
                                TickFrequency="10"
                                TickPlacement="Outside" />
                        <TextBlock VerticalAlignment="Center">
                            <Run Text="{x:Bind ConfidenceSlider.Value, Mode=OneWay}" />
                            <Run Text="%" />
                        </TextBlock>
                    </StackPanel>
                    <TextBlock Text="Les résidus avec une confiance inférieure ne seront pas présélectionnés"
                               Style="{StaticResource CaptionTextBlockStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                </StackPanel>
            </StackPanel>

            <!-- Section Apparence -->
            <StackPanel Spacing="12">
                <TextBlock Text="Apparence" Style="{StaticResource SubtitleTextBlockStyle}" />
                
                <ComboBox x:Name="ThemeComboBox"
                          Header="Thème"
                          Width="200">
                    <ComboBoxItem Content="Système" Tag="0" />
                    <ComboBoxItem Content="Clair" Tag="1" />
                    <ComboBoxItem Content="Sombre" Tag="2" />
                </ComboBox>
            </StackPanel>

            <!-- Section Données -->
            <StackPanel Spacing="12">
                <TextBlock Text="Données" Style="{StaticResource SubtitleTextBlockStyle}" />
                
                <Button x:Name="OpenBackupsFolderButton"
                        Content="Ouvrir le dossier des sauvegardes"
                        Click="OpenBackupsFolder_Click" />

                <Button x:Name="CleanupBackupsButton"
                        Content="Nettoyer les anciennes sauvegardes"
                        Click="CleanupBackups_Click" />

                <Button x:Name="ResetSettingsButton"
                        Content="Réinitialiser les paramètres"
                        Click="ResetSettings_Click" />
            </StackPanel>

            <!-- À propos -->
            <StackPanel Spacing="8">
                <TextBlock Text="À propos" Style="{StaticResource SubtitleTextBlockStyle}" />
                <TextBlock Text="Clean Uninstaller v1.0.0"
                           Style="{StaticResource CaptionTextBlockStyle}" />
                <TextBlock Text="Inspiré par BC Uninstaller"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
                <TextBlock Text="© 2025 Felix-Antoine"
                           Style="{StaticResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</ContentDialog>
