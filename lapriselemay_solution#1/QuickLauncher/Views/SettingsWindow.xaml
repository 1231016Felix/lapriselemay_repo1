<Window x:Class="QuickLauncher.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        Title="QuickLauncher - Paramètres"
        Width="850" Height="650"
        MinWidth="700" MinHeight="500"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E1E"
        ResizeMode="CanResize">
    
    <Window.Resources>
        <!-- CollectionViewSource pour grouper les commandes système par catégorie -->
        <CollectionViewSource x:Key="GroupedSystemCommands" Source="{Binding}">
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription PropertyName="Category"/>
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
        
        <Style x:Key="SettingsCheckBox" TargetType="CheckBox">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="0,6"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        
        <Style x:Key="SectionLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#0078D4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Margin" Value="0,20,0,8"/>
        </Style>
        
        <Style x:Key="SubSectionLabel" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#888"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,12,0,6"/>
        </Style>
        
        <Style x:Key="ActionButton" TargetType="Button">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Background" Value="#3E3E3E"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#4E4E4E"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource ActionButton}">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1084D8"/>
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style TargetType="TabItem">
            <Setter Property="Foreground" Value="#AAA"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="Margin" Value="2,0"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border" 
                                Background="{TemplateBinding Background}" 
                                BorderThickness="0" 
                                Padding="{TemplateBinding Padding}"
                                CornerRadius="6,6,0,0"
                                Margin="{TemplateBinding Margin}">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#3E3E3E"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#333"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <Style x:Key="SettingsCard" TargetType="Border">
            <Setter Property="Background" Value="#2D2D2D"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="Margin" Value="0,8,0,0"/>
        </Style>
    </Window.Resources>
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Titre -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,15">
            <TextBlock Text="⚙️" FontSize="28" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <StackPanel VerticalAlignment="Center">
                <TextBlock Text="Paramètres" FontSize="26" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Personnalisez QuickLauncher selon vos préférences" Foreground="#888" FontSize="11"/>
            </StackPanel>
        </StackPanel>
        
        <!-- Onglets -->
        <TabControl x:Name="MainTabControl" Grid.Row="1" Background="#252525" BorderThickness="0" SelectionChanged="MainTabControl_SelectionChanged">
            
            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- ONGLET 1: GÉNÉRAL (Démarrage + Comportement + Apparence + Raccourcis) -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <TabItem Header="🏠 Général">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Colonne gauche -->
                        <StackPanel Grid.Column="0">
                            <!-- Démarrage -->
                            <TextBlock Text="Démarrage" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <CheckBox x:Name="StartWithWindowsCheck" Content="Démarrer avec Windows" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <CheckBox x:Name="MinimizeOnStartupCheck" Content="Démarrer minimisé" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            
                            <!-- Comportement -->
                            <TextBlock Text="Comportement" Style="{StaticResource SectionLabel}"/>
                            <CheckBox x:Name="CloseAfterLaunchCheck" Content="Fermer après lancement" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <CheckBox x:Name="ShowIndexingStatusCheck" Content="Afficher le statut d'indexation" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <CheckBox x:Name="ShowSettingsButtonCheck" Content="Afficher le bouton ⚙️" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <CheckBox x:Name="SingleClickLaunchCheck" Content="Lancer en simple clic" Style="{StaticResource SettingsCheckBox}" ToolTip="Active le lancement d'un élément au simple clic (au lieu du double clic)" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            
                            <TextBlock Text="Résultats" Style="{StaticResource SubSectionLabel}"/>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Max résultats: " Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="MaxResultsValue" Text="8" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center" Width="25"/>
                            </StackPanel>
                            <Slider x:Name="MaxResultsSlider" Minimum="3" Maximum="15" Value="8" Width="250" HorizontalAlignment="Left" ValueChanged="MaxResultsSlider_ValueChanged"/>
                            
                            <ComboBox x:Name="WindowPositionCombo" Width="220" HorizontalAlignment="Left" Margin="0,10,0,0" SelectionChanged="WindowPositionCombo_SelectionChanged">
                                <ComboBoxItem Content="📍 Centré sur l'écran" Tag="Center"/>
                                <ComboBoxItem Content="📍 En haut de l'écran" Tag="Top"/>
                                <ComboBoxItem Content="📍 Mémoriser position" Tag="Remember"/>
                            </ComboBox>
                            
                            <!-- Historique -->
                            <TextBlock Text="Historique" Style="{StaticResource SectionLabel}"/>
                            <CheckBox x:Name="EnableSearchHistoryCheck" Content="Activer l'historique" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Max entrées: " Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="MaxHistoryValue" Text="10" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center" Width="25"/>
                            </StackPanel>
                            <Slider x:Name="MaxHistorySlider" Minimum="5" Maximum="30" Value="10" Width="250" HorizontalAlignment="Left" ValueChanged="MaxHistorySlider_ValueChanged"/>
                            <Button Content="🗑️ Effacer l'historique" Click="ClearHistory_Click" Style="{StaticResource ActionButton}" HorizontalAlignment="Left" Margin="0,8,0,0"/>
                            
                            <!-- Recherche intelligente -->
                            <TextBlock Text="Recherche intelligente" Style="{StaticResource SectionLabel}"/>
                            <CheckBox x:Name="EnableRecencyBonusCheck" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed">
                                <CheckBox.Content>
                                    <TextBlock Text="Prioriser les éléments récents" TextWrapping="Wrap"/>
                                </CheckBox.Content>
                                <CheckBox.ToolTip>
                                    <ToolTip MaxWidth="300">
                                        <StackPanel>
                                            <TextBlock Text="Bonus de récence" FontWeight="Bold" Margin="0,0,0,5"/>
                                            <TextBlock TextWrapping="Wrap" Text="Lorsque cette option est activée, les applications et fichiers que vous avez utilisés récemment apparaîtront plus haut dans les résultats de recherche."/>
                                            <TextBlock TextWrapping="Wrap" Margin="0,8,0,0" Foreground="#888" Text="Exemple: Si vous utilisez Chrome tous les jours, il apparaîtra avant Firefox même si vous tapez 'fire'."/>
                                        </StackPanel>
                                    </ToolTip>
                                </CheckBox.ToolTip>
                            </CheckBox>
                            <TextBlock Text="Les éléments utilisés récemment remontent dans les résultats" Foreground="#666" FontSize="10" Margin="20,0,0,0" TextWrapping="Wrap"/>
                        </StackPanel>
                        
                        <!-- Colonne droite -->
                        <StackPanel Grid.Column="2">
                            <!-- Apparence -->
                            <TextBlock Text="Apparence" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            
                            <!-- Mode thème avec Auto -->
                            <TextBlock Text="Thème" Style="{StaticResource SubSectionLabel}" Margin="0,0,0,4"/>
                            <ComboBox x:Name="ThemeModeCombo" Width="200" HorizontalAlignment="Left" SelectionChanged="ThemeModeCombo_SelectionChanged">
                                <ComboBoxItem Content="🌙 Sombre" Tag="Dark"/>
                                <ComboBoxItem Content="☀️ Clair" Tag="Light"/>
                                <ComboBoxItem Content="🌓 Auto (jour/nuit)" Tag="Auto"/>
                            </ComboBox>
                            
                            <!-- Heures pour mode Auto -->
                            <StackPanel x:Name="AutoThemePanel" Margin="15,8,0,0" Visibility="Collapsed">
                                <TextBlock Text="Plage horaire mode clair:" Foreground="#888" FontSize="11" Margin="0,0,0,4"/>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="De" Foreground="White" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <ComboBox x:Name="LightStartCombo" Width="70" SelectionChanged="AutoThemeTime_Changed">
                                        <ComboBoxItem Content="05:00" Tag="05:00"/>
                                        <ComboBoxItem Content="06:00" Tag="06:00"/>
                                        <ComboBoxItem Content="07:00" Tag="07:00"/>
                                        <ComboBoxItem Content="08:00" Tag="08:00"/>
                                        <ComboBoxItem Content="09:00" Tag="09:00"/>
                                    </ComboBox>
                                    <TextBlock Text="à" Foreground="White" VerticalAlignment="Center" Margin="8,0"/>
                                    <ComboBox x:Name="DarkStartCombo" Width="70" SelectionChanged="AutoThemeTime_Changed">
                                        <ComboBoxItem Content="17:00" Tag="17:00"/>
                                        <ComboBoxItem Content="18:00" Tag="18:00"/>
                                        <ComboBoxItem Content="19:00" Tag="19:00"/>
                                        <ComboBoxItem Content="20:00" Tag="20:00"/>
                                        <ComboBoxItem Content="21:00" Tag="21:00"/>
                                        <ComboBoxItem Content="22:00" Tag="22:00"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                <TextBlock Text="Opacité: " Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="OpacityValue" Text="100%" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Slider x:Name="OpacitySlider" Minimum="0.5" Maximum="1.0" Value="1.0" Width="250" HorizontalAlignment="Left" ValueChanged="OpacitySlider_ValueChanged"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Border x:Name="ColorPreview" Width="24" Height="24" CornerRadius="4" Background="#0078D4" Margin="0,0,8,0"/>
                                <ComboBox x:Name="AccentColorCombo" Width="150" SelectionChanged="AccentColorCombo_SelectionChanged">
                                    <ComboBoxItem Content="Bleu" Tag="#0078D4"/>
                                    <ComboBoxItem Content="Vert" Tag="#107C10"/>
                                    <ComboBoxItem Content="Rouge" Tag="#E81123"/>
                                    <ComboBoxItem Content="Orange" Tag="#FF8C00"/>
                                    <ComboBoxItem Content="Violet" Tag="#881798"/>
                                    <ComboBoxItem Content="Rose" Tag="#E3008C"/>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- Badges de catégorie -->
                            <TextBlock Text="Affichage" Style="{StaticResource SubSectionLabel}" Margin="0,12,0,4"/>
                            <CheckBox x:Name="ShowCategoryBadgesCheck" Content="Afficher les badges de catégorie" Style="{StaticResource SettingsCheckBox}" ToolTip="Affiche un badge coloré (APP, FILE, WEB...) à côté de chaque résultat" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            
                            <!-- Animations -->
                            <TextBlock Text="Animations (ouverture/fermeture)" Style="{StaticResource SubSectionLabel}" Margin="0,12,0,4"/>
                            <CheckBox x:Name="EnableAnimationsCheck" Content="Activer les animations" Style="{StaticResource SettingsCheckBox}" ToolTip="Active les animations de transition à l'ouverture et à la fermeture de la fenêtre et des résultats" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            <StackPanel x:Name="AnimationSpeedPanel" Margin="0,4,0,0">
                                <TextBlock Text="Style" Foreground="White" FontSize="12" Margin="0,0,0,4"/>
                                <ComboBox x:Name="AnimationStyleCombo" Width="250" HorizontalAlignment="Left" SelectionChanged="AnimationStyleCombo_SelectionChanged">
                                    <ComboBoxItem Content="Fade + Slide — fondu et glissement" Tag="FadeSlide"/>
                                    <ComboBoxItem Content="Fade — fondu simple" Tag="Fade"/>
                                    <ComboBoxItem Content="Scale — zoom depuis le centre" Tag="Scale"/>
                                    <ComboBoxItem Content="Slide — glissement seul" Tag="Slide"/>
                                    <ComboBoxItem Content="Pop — zoom avec rebond" Tag="Pop"/>
                                </ComboBox>
                                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                    <TextBlock Text="Durée: " Foreground="White" VerticalAlignment="Center"/>
                                    <TextBlock x:Name="AnimationSpeedValue" Text="140 ms" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center"/>
                                </StackPanel>
                                <Slider x:Name="AnimationSpeedSlider" Minimum="50" Maximum="400" Value="140" Width="250" HorizontalAlignment="Left" IsSnapToTickEnabled="True" TickFrequency="10" ValueChanged="AnimationSpeedSlider_ValueChanged"/>
                                <TextBlock Text="50 = rapide · 400 = lent" Foreground="#666" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                            
                            <!-- Raccourci clavier -->
                            <TextBlock Text="Raccourci global" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock x:Name="CurrentHotkeyDisplay" Text="Alt + Space" FontSize="18" FontWeight="Bold" Foreground="#0078D4" Margin="0,0,0,10"/>
                                    <StackPanel Orientation="Horizontal">
                                        <CheckBox x:Name="HotkeyAltCheck" Content="Alt" Foreground="White" FontSize="13" Margin="0,0,15,0" VerticalAlignment="Center" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                                        <CheckBox x:Name="HotkeyCtrlCheck" Content="Ctrl" Foreground="White" FontSize="13" Margin="0,0,15,0" VerticalAlignment="Center" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                                        <CheckBox x:Name="HotkeyShiftCheck" Content="Shift" Foreground="White" FontSize="13" Margin="0,0,15,0" VerticalAlignment="Center" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                                        <CheckBox x:Name="HotkeyWinCheck" Content="Win" Foreground="White" FontSize="13" VerticalAlignment="Center" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                                    </StackPanel>
                                    <ComboBox x:Name="HotkeyKeyCombo" Width="100" HorizontalAlignment="Left" Margin="0,8,0,0" SelectionChanged="HotkeyKeyCombo_SelectionChanged">
                                        <ComboBoxItem Content="Space" Tag="Space"/>
                                        <ComboBoxItem Content="Enter" Tag="Enter"/>
                                        <ComboBoxItem Content="Tab" Tag="Tab"/>
                                        <ComboBoxItem Content="Q" Tag="Q"/>
                                        <ComboBoxItem Content="L" Tag="L"/>
                                        <ComboBoxItem Content="F1" Tag="F1"/>
                                        <ComboBoxItem Content="F12" Tag="F12"/>
                                    </ComboBox>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- ONGLET 2: INDEXATION (Dossiers + Extensions + Navigateurs + Recherche système) -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <TabItem Header="📁 Indexation">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Colonne gauche -->
                        <StackPanel Grid.Column="0">
                            <!-- Dossiers indexés -->
                            <TextBlock Text="Dossiers indexés" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <ListBox x:Name="IndexedFoldersList" Height="180" Background="#2D2D2D" Foreground="White" BorderThickness="0"/>
                            <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                <Button Content="➕" Click="AddFolder_Click" Style="{StaticResource PrimaryButton}" Padding="10,6" Margin="0,0,5,0" ToolTip="Ajouter"/>
                                <Button Content="➖" Click="RemoveFolder_Click" Style="{StaticResource ActionButton}" Padding="10,6" ToolTip="Supprimer"/>
                            </StackPanel>
                            
                            <!-- Options -->
                            <TextBlock Text="Profondeur d'indexation" Style="{StaticResource SectionLabel}"/>
                            <TextBlock Text="Nombre de niveaux de sous-dossiers explorés au démarrage pour construire l'index de recherche." Foreground="#888" FontSize="11" TextWrapping="Wrap" Margin="0,0,0,6"/>
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Profondeur: " Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="SearchDepthValue" Text="5" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center" Width="25"/>
                                <TextBlock Text="niveaux" Foreground="#888" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Slider x:Name="SearchDepthSlider" Minimum="1" Maximum="10" Value="5" Width="250" HorizontalAlignment="Left" ValueChanged="SearchDepthSlider_ValueChanged"/>
                            <TextBlock x:Name="SearchDepthHint" Text="" Foreground="#666" FontSize="10" TextWrapping="Wrap" Margin="0,2,0,0"/>
                            <CheckBox x:Name="IndexHiddenFoldersCheck" Content="Indexer dossiers cachés" Style="{StaticResource SettingsCheckBox}" Checked="CheckBox_Changed" Unchecked="CheckBox_Changed"/>
                            
                            <!-- Réindexation -->
                            <Border Style="{StaticResource SettingsCard}" Margin="0,15,0,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="🔄" FontSize="16" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <StackPanel VerticalAlignment="Center">
                                        <TextBlock Text="Réindexer" Foreground="White" FontWeight="SemiBold"/>
                                        <TextBlock Text="Reconstruire l'index complet" Foreground="#888" FontSize="10"/>
                                    </StackPanel>
                                    <Button Content="Go" Click="Reindex_Click" Style="{StaticResource ActionButton}" VerticalAlignment="Center" Margin="15,0,0,0" Padding="12,6"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- Réindexation auto -->
                            <TextBlock Text="Réindexation automatique" Style="{StaticResource SectionLabel}"/>
                            <CheckBox x:Name="AutoReindexEnabledCheck" Content="Activer" Style="{StaticResource SettingsCheckBox}" Checked="AutoReindexEnabled_Changed" Unchecked="AutoReindexEnabled_Changed"/>
                            <StackPanel x:Name="AutoReindexOptionsPanel" Margin="15,0,0,0">
                                <RadioButton x:Name="ReindexIntervalRadio" Content="Intervalle" Foreground="White" Margin="0,3" GroupName="ReindexMode" Checked="ReindexMode_Changed"/>
                                <ComboBox x:Name="ReindexIntervalCombo" Width="120" Margin="20,3,0,3" HorizontalAlignment="Left" SelectionChanged="ReindexIntervalCombo_SelectionChanged">
                                    <ComboBoxItem Content="15 min" Tag="15"/>
                                    <ComboBoxItem Content="30 min" Tag="30"/>
                                    <ComboBoxItem Content="1 heure" Tag="60"/>
                                    <ComboBoxItem Content="2 heures" Tag="120"/>
                                </ComboBox>
                                <RadioButton x:Name="ReindexTimeRadio" Content="Heure fixe" Foreground="White" Margin="0,3" GroupName="ReindexMode" Checked="ReindexMode_Changed"/>
                                <StackPanel Orientation="Horizontal" Margin="20,3,0,0">
                                    <ComboBox x:Name="ReindexHourCombo" Width="55" SelectionChanged="ReindexTimeCombo_SelectionChanged">
                                        <ComboBoxItem Content="00h" Tag="00"/>
                                        <ComboBoxItem Content="03h" Tag="03"/>
                                        <ComboBoxItem Content="06h" Tag="06"/>
                                        <ComboBoxItem Content="12h" Tag="12"/>
                                        <ComboBoxItem Content="18h" Tag="18"/>
                                    </ComboBox>
                                    <TextBlock Text=":" Foreground="#888" VerticalAlignment="Center" Margin="3,0"/>
                                    <ComboBox x:Name="ReindexMinuteCombo" Width="55" SelectionChanged="ReindexTimeCombo_SelectionChanged">
                                        <ComboBoxItem Content="00" Tag="00"/>
                                        <ComboBoxItem Content="30" Tag="30"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- Colonne droite -->
                        <StackPanel Grid.Column="2">
                            <!-- Navigateurs -->
                            <TextBlock Text="Favoris navigateurs" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <ItemsControl x:Name="BrowsersList">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#2A2A2A" CornerRadius="4" Padding="10" Margin="0,0,0,5">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="30"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Text="{Binding Icon}" FontSize="18" VerticalAlignment="Center"/>
                                                <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="5,0">
                                                    <TextBlock Text="{Binding Name}" Foreground="White" FontSize="12"/>
                                                    <TextBlock Foreground="#666" FontSize="10">
                                                        <TextBlock.Style>
                                                            <Style TargetType="TextBlock">
                                                                <Setter Property="Text" Value="{Binding BookmarkCount, StringFormat='{}{0} favoris'}"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsInstalled}" Value="False">
                                                                        <Setter Property="Text" Value="Non installé"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                    </TextBlock>
                                                </StackPanel>
                                                <Button Grid.Column="2" Content="📥" Tag="{Binding Name}" Click="ImportBrowserBookmarks_Click" Padding="8,4" Background="#0078D4" Foreground="White" BorderThickness="0" Cursor="Hand" ToolTip="Importer">
                                                    <Button.Style>
                                                        <Style TargetType="Button">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsInstalled}" Value="False">
                                                                    <Setter Property="IsEnabled" Value="False"/>
                                                                    <Setter Property="Opacity" Value="0.4"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Button.Style>
                                                </Button>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Button Content="📥 Importer tous" Click="ImportAllBrowserBookmarks_Click" Style="{StaticResource PrimaryButton}" HorizontalAlignment="Left" Margin="0,5,0,0"/>
                            
                            <!-- Recherche système (:find) -->
                            <TextBlock Text="Recherche système (:find)" Style="{StaticResource SectionLabel}"/>
                            <Border x:Name="SearchEngineIndicator" CornerRadius="6" Padding="12" Margin="0,5,0,0">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock x:Name="SearchEngineIcon" Text="⚡" FontSize="20" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                        <TextBlock x:Name="SearchEngineName" Text="Everything" Foreground="White" FontWeight="SemiBold" FontSize="12"/>
                                        <TextBlock x:Name="SearchEngineDescription" Text="Recherche ultra-rapide" Foreground="#888" FontSize="10"/>
                                    </StackPanel>
                                    <Border Grid.Column="2" x:Name="SearchEngineStatusBadge" CornerRadius="3" Padding="8,3" VerticalAlignment="Center">
                                        <TextBlock x:Name="SearchEngineStatusText" Text="Optimal" FontSize="10" FontWeight="SemiBold"/>
                                    </Border>
                                </Grid>
                            </Border>
                            <Border x:Name="SearchEngineRecommendation" Background="#1E2A3E" CornerRadius="4" Padding="8" Margin="0,5,0,0" Visibility="Collapsed">
                                <TextBlock x:Name="SearchEngineRecommendationText" Foreground="#64B5F6" TextWrapping="Wrap" FontSize="10"/>
                            </Border>
                            <Border x:Name="WindowsSearchWarning" Background="#2A2A1E" CornerRadius="4" Padding="8" Margin="0,5,0,0" Visibility="Collapsed" Cursor="Hand" MouseLeftButtonUp="OpenWindowsIndexingSettings_Click">
                                <StackPanel>
                                    <TextBlock Text="⚠ Les résultats dépendent de la configuration d'indexation de Windows." Foreground="#FFB74D" TextWrapping="Wrap" FontSize="10"/>
                                    <TextBlock Text="Vérifiez les dossiers inclus et exclus dans les paramètres d'indexation Windows. Cliquez ici pour ouvrir les paramètres." Foreground="#999" TextWrapping="Wrap" FontSize="10" Margin="0,3,0,0"/>
                                </StackPanel>
                            </Border>
                            <Border x:Name="DirectSearchWarning" Background="#2A1E1E" CornerRadius="4" Padding="8" Margin="0,5,0,0" Visibility="Collapsed">
                                <StackPanel>
                                    <TextBlock Text="⚠ La recherche directe est limitée aux dossiers suivants :" Foreground="#FFB74D" TextWrapping="Wrap" FontSize="10"/>
                                    <TextBlock x:Name="DirectSearchFoldersList" Foreground="#999" TextWrapping="Wrap" FontSize="10" Margin="0,3,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="Profondeur de recherche" Style="{StaticResource SubSectionLabel}" Margin="0,10,0,2"/>
                            <TextBlock Text="Nombre de niveaux de sous-dossiers parcourus en temps réel par la commande :find. Plus la valeur est haute, plus la recherche est exhaustive mais lente." Foreground="#888" FontSize="11" TextWrapping="Wrap" Margin="0,0,0,6"/>
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,0">
                                <TextBlock Text="Profondeur: " Foreground="White" VerticalAlignment="Center"/>
                                <TextBlock x:Name="SystemSearchDepthValue" Text="5" Foreground="#0078D4" FontWeight="Bold" VerticalAlignment="Center" Width="25"/>
                                <TextBlock Text="niveaux" Foreground="#888" VerticalAlignment="Center"/>
                            </StackPanel>
                            <Slider x:Name="SystemSearchDepthSlider" Minimum="2" Maximum="10" Value="5" Width="250" HorizontalAlignment="Left" ValueChanged="SystemSearchDepthSlider_ValueChanged"/>
                            <TextBlock x:Name="SystemSearchDepthHint" Text="" Foreground="#666" FontSize="10" TextWrapping="Wrap" Margin="0,2,0,0"/>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,10,0,0">
                                <Button Content="🗑️ Vider cache" Click="ClearSearchCache_Click" Style="{StaticResource ActionButton}" Padding="10,6"/>
                                <TextBlock x:Name="SearchCacheStats" Text="" Foreground="#666" FontSize="10" VerticalAlignment="Center" Margin="10,0,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- ONGLET 3: COMMANDES (Recherche Web + Contrôle Système) -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <TabItem Header="🔍 Commandes">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Colonne gauche: Recherche Web -->
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="Recherche Web" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <TextBlock Text="Tapez le préfixe + espace + recherche (ex: g pizza)" Foreground="#888" FontSize="11" Margin="0,0,0,8"/>
                            
                            <ListBox x:Name="SearchEnginesList" Height="180" Background="#2D2D2D" Foreground="White" BorderThickness="0">
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid Margin="5,3">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="45"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Background="#0078D4" CornerRadius="3" Padding="6,2" HorizontalAlignment="Left">
                                                <TextBlock Text="{Binding Prefix}" FontWeight="Bold" Foreground="White" FontSize="11"/>
                                            </Border>
                                            <TextBlock Grid.Column="1" Text="{Binding Name}" VerticalAlignment="Center" Margin="8,0" FontSize="12"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                            </ListBox>
                            
                            <!-- Commandes intégrées -->
                            <TextBlock Text="Commandes intégrées" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="80"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":settings" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Paramètres" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="80"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":reload" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Réindexer" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="80"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":history" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Historique" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="80"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":help" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Aide" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="80"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":quit" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Quitter" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- Intégrations web -->
                            <TextBlock Text="Intégrations web" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="Météo (:weather)" Foreground="White" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                        <TextBlock Text="Ville par défaut:" Foreground="#AAA" FontSize="12" VerticalAlignment="Center" Width="110"/>
                                        <TextBox x:Name="WeatherCityBox" Width="160" Background="#1E1E1E" Foreground="White" BorderBrush="#555" BorderThickness="1" Padding="6,4" FontSize="12" KeyDown="WeatherCityBox_KeyDown" LostFocus="WeatherCityBox_LostFocus"/>
                                        <Button x:Name="WeatherValidateBtn" Content="✓" Click="WeatherValidateBtn_Click" Background="#3E3E3E" Foreground="White" Padding="8,4" BorderThickness="0" Cursor="Hand" Margin="4,0,0,0" ToolTip="Valider la ville" FontWeight="Bold"/>
                                    </StackPanel>
                                    <Border x:Name="WeatherValidationPanel" CornerRadius="4" Padding="8,4" Margin="0,4,0,0" Visibility="Collapsed">
                                        <TextBlock x:Name="WeatherValidationText" FontSize="11" TextWrapping="Wrap"/>
                                    </Border>
                                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                        <TextBlock Text="Unité:" Foreground="#AAA" FontSize="12" VerticalAlignment="Center" Width="110"/>
                                        <ComboBox x:Name="WeatherUnitCombo" Width="160" SelectionChanged="WeatherUnitCombo_SelectionChanged">
                                            <ComboBoxItem Content="°C Celsius" Tag="celsius"/>
                                            <ComboBoxItem Content="°F Fahrenheit" Tag="fahrenheit"/>
                                        </ComboBox>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                        
                        <!-- Colonne droite: Contrôle Système -->
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Contrôle Système" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <TextBlock Text="Tapez ':' + préfixe dans la barre de recherche • Cliquez pour modifier" Foreground="#888" FontSize="11" Margin="0,0,0,8"/>
                            
                            <ScrollViewer MaxHeight="280" VerticalScrollBarVisibility="Auto">
                                <ItemsControl x:Name="SystemCommandsList">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#2A2A2A" CornerRadius="4" Padding="10,8" Margin="0,3" Cursor="Hand" MouseLeftButtonUp="SystemCommandItem_Click">
                                                <Border.ToolTip>
                                                    <ToolTip Background="#2D2D2D" BorderBrush="#555" Padding="12">
                                                        <StackPanel MaxWidth="280">
                                                            <TextBlock Text="{Binding Name}" FontWeight="Bold" Foreground="White" FontSize="13"/>
                                                            <TextBlock Text="{Binding Description}" TextWrapping="Wrap" Foreground="#CCC" Margin="0,6,0,0"/>
                                                            <TextBlock Text="{Binding Category, StringFormat='Catégorie: {0}'}" Foreground="#0078D4" FontSize="10" Margin="0,6,0,0"/>
                                                        </StackPanel>
                                                    </ToolTip>
                                                </Border.ToolTip>
                                                <Border.Style>
                                                    <Style TargetType="Border">
                                                        <Style.Triggers>
                                                            <Trigger Property="IsMouseOver" Value="True">
                                                                <Setter Property="Background" Value="#353535"/>
                                                            </Trigger>
                                                            <DataTrigger Binding="{Binding IsEnabled}" Value="False">
                                                                <Setter Property="Opacity" Value="0.4"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Border.Style>
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Grid.Column="0" Text="{Binding Icon}" FontSize="18" VerticalAlignment="Center" Margin="0,0,12,0"/>
                                                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                        <TextBlock Text="{Binding Prefix, StringFormat=:{0}}" Foreground="#0078D4" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                        <TextBlock Text="{Binding Category}" Foreground="#888" FontSize="10" Margin="0,2,0,0"/>
                                                    </StackPanel>
                                                    <Border Grid.Column="2" Width="32" Height="16" CornerRadius="8" VerticalAlignment="Center" MouseLeftButtonUp="ToggleSwitch_Click" Tag="{Binding}">
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Setter Property="Background" Value="#404040"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsEnabled}" Value="True">
                                                                        <Setter Property="Background" Value="#0078D4"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                        <Ellipse Width="12" Height="12" Fill="White" VerticalAlignment="Center">
                                                            <Ellipse.Style>
                                                                <Style TargetType="Ellipse">
                                                                    <Setter Property="HorizontalAlignment" Value="Left"/>
                                                                    <Setter Property="Margin" Value="2,0,0,0"/>
                                                                    <Style.Triggers>
                                                                        <DataTrigger Binding="{Binding IsEnabled}" Value="True">
                                                                            <Setter Property="HorizontalAlignment" Value="Right"/>
                                                                            <Setter Property="Margin" Value="0,0,2,0"/>
                                                                        </DataTrigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </Ellipse.Style>
                                                        </Ellipse>
                                                    </Border>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                            
                            <!-- Panneau d'édition amélioré -->
                            <Border x:Name="CommandEditPanel" Background="#1A3A5C" CornerRadius="8" Padding="16" Margin="0,12,0,0" Visibility="Collapsed" BorderBrush="#0078D4" BorderThickness="1">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- En-tête avec nom et bouton fermer -->
                                    <Grid Grid.Row="0" Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="✏️" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock x:Name="EditCommandName" Text="Modifier la commande" FontSize="14" FontWeight="SemiBold" Foreground="White"/>
                                            <TextBlock x:Name="EditCommandDescription" Text="" FontSize="11" Foreground="#88AACC" TextTrimming="CharacterEllipsis" MaxWidth="220"/>
                                        </StackPanel>
                                        <Button Grid.Column="2" Content="✕" Click="CancelCommandEdit_Click" Background="Transparent" Foreground="#888" Width="24" Height="24" BorderThickness="0" Cursor="Hand" FontSize="14" VerticalAlignment="Top">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                    
                                    <!-- Champs d'édition -->
                                    <Grid Grid.Row="1" Margin="0,0,0,12">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="12"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Préfixe -->
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Préfixe" Foreground="#88AACC" FontSize="11" Margin="0,0,0,4"/>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Border Background="#0D2840" CornerRadius="4,0,0,4" Padding="10,8">
                                                    <TextBlock Text=":" Foreground="#0078D4" FontFamily="Consolas" FontSize="14" FontWeight="Bold"/>
                                                </Border>
                                                <TextBox x:Name="CommandPrefixBox" Grid.Column="1" Background="#0D2840" Foreground="White" BorderThickness="0" Padding="8" FontFamily="Consolas" FontSize="14" VerticalContentAlignment="Center"/>
                                            </Grid>
                                        </StackPanel>
                                        
                                        <!-- Icône -->
                                        <StackPanel Grid.Column="2">
                                            <TextBlock Text="Icône" Foreground="#88AACC" FontSize="11" Margin="0,0,0,4"/>
                                            <TextBox x:Name="CommandIconBox" Width="50" Background="#0D2840" Foreground="White" BorderThickness="0" Padding="8" TextAlignment="Center" FontSize="18" VerticalContentAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <!-- Boutons d'action -->
                                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
                                        <Button Content="Annuler" Click="CancelCommandEdit_Click" Background="#2A4A6A" Foreground="#AAA" Padding="16,8" BorderThickness="0" Cursor="Hand" Margin="0,0,8,0">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#3A5A7A"/>
                                                            <Setter Property="Foreground" Value="White"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <Button Content="✓ Appliquer" Click="ApplyCommandEdit_Click" Background="#0078D4" Foreground="White" Padding="16,8" BorderThickness="0" Cursor="Hand" FontWeight="SemiBold">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#1088E4"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                            
                            <Button Content="🔄 Réinitialiser" Click="ResetSystemCommands_Click" Style="{StaticResource ActionButton}" HorizontalAlignment="Left" Margin="0,10,0,0"/>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
            
            <!-- ═══════════════════════════════════════════════════════════ -->
            <!-- ONGLET 4: À PROPOS (Guide + Stats + Infos) -->
            <!-- ═══════════════════════════════════════════════════════════ -->
            <TabItem Header="ℹ️ À propos">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="20"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- Colonne gauche: Guide -->
                        <StackPanel Grid.Column="0">
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,15">
                                <TextBlock Text="🚀" FontSize="36" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                <StackPanel VerticalAlignment="Center">
                                    <TextBlock Text="QuickLauncher" FontSize="22" FontWeight="Bold" Foreground="White"/>
                                    <TextBlock Text="Version 1.0.0 • Par Felix-Antoine" Foreground="#888" FontSize="11"/>
                                </StackPanel>
                            </StackPanel>
                            
                            <TextBlock Text="Raccourcis clavier" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="100"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text="Entrée" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Lancer l'élément" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="100"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text="Ctrl+Entrée" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Exécuter en admin" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="100"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text="Échap" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Fermer" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="Astuces" Style="{StaticResource SectionLabel}"/>
                            <Border Background="#2D3D2D" CornerRadius="6" Padding="12" BorderBrush="#4CAF50" BorderThickness="1">
                                <StackPanel>
                                    <TextBlock Text="• ⭐ Épinglez vos apps favorites (clic droit → Épingler)" Foreground="#AAA" FontSize="11" Margin="0,2"/>
                                    <TextBlock Text="• Les épinglés apparaissent quand la barre est vide" Foreground="#AAA" FontSize="11" Margin="0,2"/>
                                    <TextBlock Text="• Tapez ':help' pour voir toutes les commandes" Foreground="#AAA" FontSize="11" Margin="0,2"/>
                                    <TextBlock Text="• Calculatrice intégrée: tapez '2+2*3'" Foreground="#AAA" FontSize="11" Margin="0,2"/>
                                    <TextBlock Text="• Clic droit pour actions contextuelles" Foreground="#AAA" FontSize="11" Margin="0,2"/>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="🌤️ Commande :weather" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="Affiche la météo en temps réel." Foreground="#AAA" FontSize="11" Margin="0,0,0,6"/>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="160"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":weather" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Météo de la ville par défaut" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="160"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":weather Paris" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Météo d'une autre ville" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <TextBlock Text="💡 La ville par défaut se configure dans l'onglet Commandes." Foreground="#666" FontSize="10" FontStyle="Italic" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="🌐 Commande :translate" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock Text="Traduit du texte entre plusieurs langues." Foreground="#AAA" FontSize="11" Margin="0,0,0,6"/>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="170"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":translate hello" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Détecte la langue → traduit" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="170"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":translate fr hello" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Traduit vers le français" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <Grid Margin="0,2"><Grid.ColumnDefinitions><ColumnDefinition Width="170"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                        <TextBlock Text=":translate en>fr hello" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/>
                                        <TextBlock Grid.Column="1" Text="Anglais → Français" Foreground="#888" FontSize="11"/>
                                    </Grid>
                                    <TextBlock Text="💡 Entrée pour copier le résultat. Codes longs aussi acceptés (eng, french, allemand...)." Foreground="#666" FontSize="10" FontStyle="Italic" TextWrapping="Wrap" Margin="0,6,0,0"/>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="Codes de langues" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="20"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <StackPanel Grid.Column="0">
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="fr" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Français" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="en" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Anglais" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="es" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Espagnol" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="de" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Allemand" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="it" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Italien" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="pt" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Portugais" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="nl" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Néerlandais" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="ru" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Russe" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="zh" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Chinois" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="ja" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Japonais" Foreground="#888" FontSize="11"/></Grid>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2">
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="ko" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Coréen" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="ar" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Arabe" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="hi" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Hindi" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="pl" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Polonais" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="tr" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Turc" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="sv" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Suédois" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="el" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Grec" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="ro" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Roumain" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="cs" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Tchèque" Foreground="#888" FontSize="11"/></Grid>
                                        <Grid Margin="0,1"><Grid.ColumnDefinitions><ColumnDefinition Width="30"/><ColumnDefinition Width="*"/></Grid.ColumnDefinitions>
                                            <TextBlock Text="hu" Foreground="#0078D4" FontFamily="Consolas" FontSize="11"/><TextBlock Grid.Column="1" Text="Hongrois" Foreground="#888" FontSize="11"/></Grid>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </StackPanel>
                        
                        <!-- Colonne droite: Stats et données -->
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Statistiques" Style="{StaticResource SectionLabel}" Margin="0,0,0,8"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <TextBlock x:Name="StatsText" Text="Chargement..." Foreground="#888" FontSize="11"/>
                            </Border>
                            
                            <TextBlock Text="Données" Style="{StaticResource SectionLabel}"/>
                            <Border Style="{StaticResource SettingsCard}">
                                <StackPanel>
                                    <TextBlock x:Name="DataPathText" Text="" Foreground="#888" TextWrapping="Wrap" FontFamily="Consolas" FontSize="10"/>
                                    <Button Content="📂 Ouvrir le dossier" Click="OpenDataFolder_Click" Style="{StaticResource ActionButton}" Margin="0,10,0,0" HorizontalAlignment="Left"/>
                                </StackPanel>
                            </Border>
                            
                            <TextBlock Text="Zone dangereuse" Style="{StaticResource SectionLabel}"/>
                            <Border Background="#3D2020" CornerRadius="6" Padding="12" BorderBrush="#E81123" BorderThickness="1">
                                <StackPanel>
                                    <TextBlock Text="Réinitialiser tous les paramètres aux valeurs par défaut." Foreground="#888" TextWrapping="Wrap" FontSize="11" Margin="0,0,0,10"/>
                                    <Button Content="🗑️ Réinitialiser" Click="ResetSettings_Click" Background="#E81123" Foreground="White" Padding="10,6" BorderThickness="0" HorizontalAlignment="Left" Cursor="Hand"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </ScrollViewer>
            </TabItem>
        </TabControl>
        
        <!-- Barre de statut -->
        <Border Grid.Row="2" BorderBrush="#3E3E3E" BorderThickness="0,1,0,0" Padding="0,15,0,0" Margin="0,15,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Avertissement redémarrage requis -->
                <Border x:Name="RestartWarningPanel" Grid.Column="0" Background="#3D2D10" CornerRadius="6" Padding="12,8" Visibility="Collapsed">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="⚠️" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="Le raccourci clavier a été modifié. Un redémarrage est nécessaire." Foreground="#FFB900" VerticalAlignment="Center" FontSize="12"/>
                        <Button Content="Redémarrer" Click="RestartApp_Click" Background="#FFB900" Foreground="Black" Padding="10,4" Margin="15,0,0,0" BorderThickness="0" Cursor="Hand" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>
                
                <!-- Indicateur de sauvegarde auto -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock x:Name="AutoSaveIndicator" Text="💾 Sauvegarde automatique" Foreground="#666" FontSize="11" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
